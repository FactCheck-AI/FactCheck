UVALDE, Texas—The 18-year-old gunman who opened fire at a Texas elementary school, killing at least 19 kids and two adults, wrote three disturbing messages on Facebook just minutes before the massacre, warning of the carnage to come.

“I’m going to shoot my grandmother,” Salvador Ramos wrote about 30 minutes before his rampage at Robb Elementary School, Texas Gov. Greg Abbott said Wednesday.

Ramos made good on his vow, writing minutes later that he’d “shot my grandmother.” His last message foretold of his final act of unspeakable violence: “I’m going to shoot an elementary school,” he wrote about 15 minutes before he arrived on campus.

Abbott revealed the shooter’s final posts at a press conference, saying there was “no meaningful forewarning of this crime.” (Facebook specified that they were private one-on-one messages, not public posts.)

The messages mirror texts Ramos reportedly sent to a 15-year-old female acquaintance in Germany, who then shared them with CNN, in which he indicated he erupted because he was annoyed his grandmother took issue with his phone bill.

But Ramos legally bought two AR-style rifles just after his 18th birthday this month and appeared to grow angry and isolated after he failed to graduate high school, friends and family members said.

Although Ramos was described as “quiet” by numerous people who knew him, a young woman who worked with him at Wendy’s until March detected an aggressive streak. Several former friends said he had stopped showing up at school and was not going to graduate with the senior class this year.

“He would be very rude towards the girls sometimes, and one of the cooks, threatening them by asking, ‘Do you know who I am?’ And he would also send inappropriate texts to the ladies,” said the former co-worker, who did not want her name used.

“At the park, there’d be videos of him trying to fight people with boxing gloves. He’d take them around with him.”

Natalie B., 19, who lives a block away from Ramos’ grandma said she knew the shooter from high school. “He had anger issues. People are saying he was bullied but I didn’t see that. He was more like the bully,” she told The Daily Beast.

Ramos’ grandfather, Ronald Reyes, told ABC News that Ramos didn’t go to school last year and spent a lot of time alone in his room in his grandparents’ modest bungalow in Uvalde. “He didn’t talk very much,” said Reyes, who added that Ramos moved out of his mom’s home after they had “problems.”

In an interview at a local hospital where Ramos’ grandmother, Celia Gonzalez, is being treated, the shooter’s mom, Adriana Reyes, told the Daily Mail she was surprised by her son’s rampage.

“My son wasn’t a violent person,” she claimed. “I had a good relationship with him. He kept to himself; he didn’t have many friends.” She said the last time they spoke was Ramos’ birthday when she gave him a card and “a Snoopy stuffed animal.”

But the mom’s live-in boyfriend, 62-year-old Juan Alvarez, told NBC News that the teen had a turbulent relationship with Reyes and left her home after a fight over the Wi-Fi. “He was kind of a weird one. I never got along with him. I never socialized with him. He doesn’t talk to nobody,” he said. “When you try to talk to him he’d just sit there and walk away.”

Ronald Reyes said his grandson celebrated his 18th birthday on May 16 with a trip to Applebee’s with his grandmother—but they had no idea he also celebrated by purchasing two AR-15-style rifles and 375 rounds of ammunition.

On Tuesday morning, Reyes said a neighbor alerted him that Ramos, who is unlicensed, had shot his grandmother and taken his grandmother’s truck. Newsy reported that a neighbor named Eduardo said Ramos was angry that he didn’t graduate and got into an argument with his grandmother. She was screaming, “He shot me! He shot me!” the neighbor recounted to Newsy.

Ramos then crashed the truck near Robb Elementary, prompting a witness to call 911. Local police pursued him as he ran into the school wearing a tactical-style vest and carrying a rifle, Texas DPS spokesperson Lt. Chris Olivarez said. He barricaded himself in a classroom and started shooting “whoever was in his way,” Olivarez said.

Ramos was unemployed and had no criminal history, Olivarez said.

Former friend Santos Valdez Jr. told TheWashington Post that the two had been close friends until Ramos’ behavior started to “deteriorate.” He said Ramos, who was often bullied over a speech impediment that included a stutter and lisp, once cut up his own face with a knife “just for fun.” Valdez said he first said he was scratched by a cat and then admitted he had done it himself. “Then he told me the truth, that he’d cut up his face with knives over and over,” Valdez told the Post, adding that he had messaged over Instagram two hours before the massacre. Ramos didn’t open or read Valdez’s final message.

Another friend told the paper that he used to egg people’s vehicles and shoot random strangers with a BB gun from a car.

Hours before the shooting, an Instagram account that appears to have belonged to Ramos sent direct messages to a teenager in Los Angeles, telling her he wanted to share a “lil secret,” according to screenshots shared by the recipient, who said she barely knew Ramos but had been randomly tagged by him in photos of guns before.

He said he’d text the person in an hour and she’d have to respond, but she said she might not be awake. The last thing he wrote was, “Ima air out.”

The same Instagram account was deleted shortly after Texas Gov. Greg Abbott identified him as the shooter. It featured photos and stories of semiautomatic firearms—as well as selfies of someone who strongly resembled a photo of the killer shared by the Texas Department of Public Safety. A TikTok account with the same handle and profile picture, also taken offline on Tuesday, featured only a clip of a mobile game and the line “Kids be scared IRL.” Both accounts used the bio line TheBiggestOpp.

The Instagram account posted an image three days before the shooting of two rifles, including what appeared to be a Daniel Defense AR-15 with a high-capacity magazine. Another image from April 28 showed someone holding a magazine.

Texas Sen. John Whitmire said he’d been briefed by state police that Ramos legally purchased two “AR platform rifles” on May 17 and May 20, plus 375 rounds of ammunition on May 18. (Texas State Sen. Roland Gutierrez earlier told CNN that the rifles were purchased on Ramos’ birthday.) One rifle was in Ramos’ truck that crashed near the school, the other was with him.

Former high school classmate Nadia Reyes recalled to the Post that he had posted an Instagram story showing himself screaming at his mother—who has not commented publicly—and calling her a bitch as she tried to kick him out of the house. “He posted videos on his Instagram where the cops were there,” Reyes told the Post. “He’d be screaming and talking to his mom really aggressively.”

Days before the shooting, Ramos texted an old classmate photos of a firearm and a bag of ammo, CNN reported. “He would message me here and there, and four days ago he sent me a picture of the AR he was using… and a backpack full of 5.56 rounds, probably like seven mags,” the unidentified friend said, “I was like, ‘Bro, why do you have this?’ and he was like, ‘Don’t worry about it.’”

“He proceeded to text me, ‘I look very different now. You wouldn’t recognize me,’” the friend added.

He said Ramos was sometimes bullied for his clothing or his family’s finances, and “he just, like, slowly dropped out” of school.

John Morales, who lives next door to Ramos’ paternal grandmother, told The Daily Beast that the teen used to play the first-person shooter game Call of Duty with Morales’ 15-year-old son. But he said he had not seen Ramos around the neighborhood for quite some time.

“I didn’t recognize him in the picture until I saw the name. Cause he had shorter hair, back in the day when I used to see him around here,” he said.

Nayeli, an 18-year-old who declined to give her last name, told The Daily Beast late Tuesday that she and Ramos had been students together, but she didn’t know him well. “I had a math class with him,” she said, adding, “He was pretty quiet in class.”

The Wendy’s co-worker said Ramos did not seem to socialize much outside his clique of friends—a group she described as “emo” or “alternative.”

Janie Aviles, a great-grandmother who lives next door to Ramos’ paternal grandmother, said Ramos would sometimes help her clean outside her house. “But that was when he was little,” Aviles said, holding her hand at chest height. “He hasn’t done that recently.”

Aviles’ son, Gillardo Galindo, a produce packer at Cargill, told The Daily Beast that he would see Ramos approximately “every two months,” but said Ramos hadn’t been around much recently.

He said that some of his coworkers at Cargill had family affected by the shooting. “When they heard about all this, they had some cousins, you know, or family at the school. They took off when they learned the kids had been shot.”